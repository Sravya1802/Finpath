<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Dashboard - FinPath</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <div class="container" style="max-width: 1200px; padding: 20px;">
        <!-- Header -->
        <div style="background: linear-gradient(135deg, var(--primary-blue) 0%, var(--soft-green) 100%); padding: 20px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 10px var(--shadow);">
            <h1 id="user-welcome" style="color: var(--text-dark); margin-bottom: 5px; font-size: 1.8em;">Your Financial Dashboard</h1>
            <p id="user-info" style="color: var(--text-dark); font-size: 1em; margin: 0;">Welcome back! Here's your financial overview</p>
        </div>

        <!-- Critical Alerts Section -->
        <div id="critical-alerts-container" style="margin-bottom: 25px;"></div>

        <!-- Quick Stats & Progress -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
            <div id="progress-tracking" style="display: contents;"></div>
        </div>

        <!-- Main Navigation Cards -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 25px;">
            
            <!-- Credit & Banking -->
            <div class="card" onclick="window.location.href='dashboard-credit.html'" style="border: 2px solid var(--border-color); border-radius: 12px; padding: 20px; background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px var(--shadow)'">
                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ’³</div>
                <h3 style="color: var(--accent-green); margin: 0 0 8px 0; font-size: 1.3em;">Credit & Banking</h3>
                <p style="color: var(--text-medium); margin: 0; font-size: 0.9em;">Credit calculators, bank comparison, and payment tools</p>
            </div>

            <!-- Tax & Deadlines -->
            <div class="card" onclick="window.location.href='dashboard-tax.html'" style="border: 2px solid var(--border-color); border-radius: 12px; padding: 20px; background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px var(--shadow)'">
                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“…</div>
                <h3 style="color: #FF9800; margin: 0 0 8px 0; font-size: 1.3em;">Tax & Deadlines</h3>
                <p style="color: var(--text-medium); margin: 0; font-size: 0.9em;">Important deadlines and tax information</p>
            </div>

            <!-- Money Transfer -->
            <div class="card" onclick="window.location.href='dashboard-transfer.html'" style="border: 2px solid var(--border-color); border-radius: 12px; padding: 20px; background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px var(--shadow)'">
                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ’¸</div>
                <h3 style="color: #9C27B0; margin: 0 0 8px 0; font-size: 1.3em;">Money Transfer</h3>
                <p style="color: var(--text-medium); margin: 0; font-size: 0.9em;">Compare international transfer services</p>
            </div>

            <!-- Learning Center -->
            <div class="card" onclick="window.location.href='dashboard-learning.html'" style="border: 2px solid var(--border-color); border-radius: 12px; padding: 20px; background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px var(--shadow)'">
                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“š</div>
                <h3 style="color: #00796B; margin: 0 0 8px 0; font-size: 1.3em;">Learning Center</h3>
                <p style="color: var(--text-medium); margin: 0; font-size: 0.9em;">Cultural guides and error prevention</p>
            </div>

            <!-- Regular Alerts -->
            <div class="card" onclick="window.location.href='dashboard-alerts.html'" style="border: 2px solid var(--border-color); border-radius: 12px; padding: 20px; background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px var(--shadow)'">
                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ””</div>
                <h3 style="color: #C62828; margin: 0 0 8px 0; font-size: 1.3em;">All Alerts</h3>
                <p style="color: var(--text-medium); margin: 0; font-size: 0.9em;">View all alerts and reminders</p>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons" style="margin-top: 20px; text-align: center;">
            <a href="index.html" class="btn" style="padding: 10px 20px; font-size: 0.9em;">â† Home</a>
        </div>
    </div>

    <!-- Chatbot Button -->
    <button class="chatbot-button" id="chatbot-button" title="Chat with FinPath Assistant" aria-label="Open chatbot">ğŸ’¬</button>

    <!-- Chatbot Panel -->
    <div class="chatbot-panel" id="chatbot-panel">
        <div class="chatbot-header">
            <span>FinPath Assistant</span>
            <button class="chatbot-close" id="chatbot-close" aria-label="Close chatbot">Ã—</button>
        </div>
        <div class="chatbot-messages" id="chatbot-messages"></div>
        <div class="chatbot-input-container">
            <input type="text" class="chatbot-input" id="chatbot-input" placeholder="Ask a question...">
            <button class="chatbot-send" id="chatbot-send">Send</button>
        </div>
    </div>

    <script src="scripts/navigation.js"></script>
    <script src="scripts/chatbot.js"></script>
    <script>
        // Get user data
        function getUserData() {
            const data = localStorage.getItem('userData');
            return data ? JSON.parse(data) : null;
        }

        // Get selected visa
        function getSelectedVisa() {
            const userData = getUserData();
            return userData?.visaType || localStorage.getItem('selectedVisa') || 'F-1';
        }

        // Alerts data
        const alertsData = {
            'F-1': {
                critical: [
                    { title: 'Tax Filing Deadline Approaching', message: 'File Form 1040NR by April 15th if you have U.S. income', date: 'Due in 45 days', icon: 'ğŸš¨' }
                ]
            },
            'H-1B': {
                critical: [
                    { title: 'Tax Filing Deadline Approaching', message: 'File Form 1040 by April 15th', date: 'Due in 45 days', icon: 'ğŸš¨' },
                    { title: '401(k) Contribution Deadline', message: 'Maximize your 401(k) contributions before December 31st', date: 'Due in 30 days', icon: 'ğŸ’°' }
                ]
            },
            'Refugee': {
                critical: [
                    { title: 'SSN Application Urgent', message: 'Apply for Social Security Number immediately if you haven\'t already', date: 'Urgent', icon: 'ğŸš¨' }
                ]
            }
        };

        // Progress Tracking Data
        const progressData = {
            'F-1': [
                { label: 'Credit Score', value: 'Building', icon: 'ğŸ“Š', status: 'in-progress' },
                { label: 'Bank Account', value: 'Active', icon: 'ğŸ¦', status: 'complete' },
                { label: 'Tax Filing', value: 'Pending', icon: 'ğŸ“…', status: 'pending' },
                { label: 'SSN Obtained', value: 'Yes', icon: 'ğŸ†”', status: 'complete' }
            ],
            'H-1B': [
                { label: 'Credit Score', value: 'Good', icon: 'ğŸ“Š', status: 'complete' },
                { label: '401(k) Setup', value: 'Active', icon: 'ğŸ’°', status: 'complete' },
                { label: 'Tax Filing', value: 'Pending', icon: 'ğŸ“…', status: 'pending' },
                { label: 'Emergency Fund', value: 'Building', icon: 'ğŸ’µ', status: 'in-progress' }
            ],
            'Refugee': [
                { label: 'SSN Obtained', value: 'Yes', icon: 'ğŸ†”', status: 'complete' },
                { label: 'Bank Account', value: 'Active', icon: 'ğŸ¦', status: 'complete' },
                { label: 'Credit Building', value: 'Starting', icon: 'ğŸ“Š', status: 'in-progress' },
                { label: 'Benefits Applied', value: 'In Progress', icon: 'ğŸ¤', status: 'in-progress' }
            ]
        };

        // Load Critical Alerts
        function loadCriticalAlerts() {
            try {
                const visaType = getSelectedVisa();
                const alerts = alertsData[visaType] || alertsData['F-1'];
                const container = document.getElementById('critical-alerts-container');
                
                if (!container || !alerts.critical || alerts.critical.length === 0) {
                    container.innerHTML = '';
                    return;
                }
                
                container.innerHTML = '<h3 style="color: #F44336; margin-bottom: 12px; font-size: 1.2em;">ğŸš¨ Critical Alerts</h3>';
                
                alerts.critical.forEach(function(alert) {
                    const alertBox = document.createElement('div');
                    alertBox.style.cssText = 'padding: 15px; margin-bottom: 10px; background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); border: 2px solid #F44336; border-left: 5px solid #F44336; border-radius: 8px;';
                    alertBox.innerHTML = 
                        '<div style="display: flex; align-items: start; gap: 10px;">' +
                            '<span style="font-size: 1.5em;">' + alert.icon + '</span>' +
                            '<div style="flex: 1;">' +
                                '<h4 style="color: #C62828; margin: 0 0 5px 0; font-size: 1em; font-weight: 700;">' + alert.title + '</h4>' +
                                '<p style="color: var(--text-dark); margin: 0 0 8px 0; font-size: 0.9em;">' + alert.message + '</p>' +
                                '<span style="padding: 4px 10px; background-color: #F44336; color: white; border-radius: 12px; font-size: 0.8em; font-weight: 600;">' + alert.date + '</span>' +
                            '</div>' +
                        '</div>';
                    container.appendChild(alertBox);
                });
            } catch (error) {
                console.error('Error loading critical alerts:', error);
            }
        }

        // Load Progress Tracking
        function loadProgressTracking() {
            try {
                const visaType = getSelectedVisa();
                const progress = progressData[visaType] || progressData['F-1'];
                const container = document.getElementById('progress-tracking');
                
                if (!container) return;
                
                progress.forEach(function(item) {
                    const progressBox = document.createElement('div');
                    var statusColor = '';
                    var statusBg = '';
                    if (item.status === 'complete') {
                        statusColor = '#4CAF50';
                        statusBg = '#E8F5E9';
                    } else if (item.status === 'in-progress') {
                        statusColor = '#2196F3';
                        statusBg = '#E3F2FD';
                    } else {
                        statusColor = '#FF9800';
                        statusBg = '#FFF3E0';
                    }
                    
                    progressBox.style.cssText = 'padding: 15px; background-color: ' + statusBg + '; border-radius: 10px; border-left: 4px solid ' + statusColor + '; text-align: center;';
                    progressBox.innerHTML = 
                        '<div style="font-size: 2em; margin-bottom: 8px;">' + item.icon + '</div>' +
                        '<div style="font-size: 0.85em; color: var(--text-medium); margin-bottom: 5px;">' + item.label + '</div>' +
                        '<div style="font-weight: 700; color: ' + statusColor + '; font-size: 1em;">' + item.value + '</div>';
                    
                    container.appendChild(progressBox);
                });
            } catch (error) {
                console.error('Error loading progress tracking:', error);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            try {
                const userData = getUserData();
                const welcomeEl = document.getElementById('user-welcome');
                if (userData && userData.name && welcomeEl) {
                    welcomeEl.textContent = 'Welcome, ' + userData.name + '!';
                }
                
                loadCriticalAlerts();
                loadProgressTracking();
            } catch (error) {
                console.error('Error initializing dashboard:', error);
            }
        });
    </script>

    <style>
        @media (max-width: 768px) {
            .container > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
            }
        }
    </style>
</body>
</html>
